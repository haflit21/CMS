{% extends "::admin.html.twig" %}
{% block title "Users" %}

{% block body %}
<div class="row-fluid">
	<div class="span12">
		<h1 class="pull-left">{% trans %}Users{% endtrans %}</h1>
		<a href="{{ path('new_user') }}" class="btn-new btn-small pull-right"><i class="admin-icon-plus-circled"></i> {% trans %}New{% endtrans %}</a>
		{% if app.session.hasFlash('error') %}
			<div class="clear h20"></div>
		    <div class="alert alert-error">
		  		<a class="close" data-dismiss="alert" href="#">×</a>
		        {{ app.session.flash('error') }}
		    </div>
		{% elseif app.session.hasFlash('success') %}
			<div class="clear h20"></div>
		    <div class="alert alert-success">
		  		<a class="close" data-dismiss="alert" href="#">×</a>
		        {{ app.session.flash('success') }}
		    </div>
		{% endif %}

		<div class="clear h20"></div>
		<form action="{{ path('users', {'page': 1}) }}" method="post" id="form-main">
			<table class="table table-striped">
				<thead>
					<tr>
						<th>Id</th>
						<th>Username</th>
						<th>Name</th>
						<th>Email</th>
						<th>Roles</th>
						<th colspan="2">Actions</th>
					</tr>
				</thead>
				<tbody>
				{% for user in users %}
				<tr>
					<td>{{ user.id }}</td>
					<td>{{ user.username }}</td>
					<td>{{ user.firstname }} {{ user.lastname }}</td>
					<td>{{ user.email }}</td>
					<td>
					{% set tab = '' %}
					{% for group in user.groups %}
						 {% set tab = [group.name] %}
					{% endfor %}
					{{ tab|join(',') }}
					</td>
					<td><a href="{{ path('edit_user', { 'id' : user.id }) }}" class="icon-edit">&nbsp;</a>
					<td><a href="#myModal-{{ user.id }}" data-toggle="modal" class="icon-trash">&nbsp;</a>
					<div class="modal hide" id="myModal-{{ user.id }}">
						<div class="modal-header">
					    	<button type="button" class="close" data-dismiss="modal">×</button>
					    	<h3>Utilsateur</h3>
					    </div>
					    <div class="modal-body">
					    	<p>Voulez-vous supprimer cet utilisateur ?</p>
					    </div>
					    <div class="modal-footer">
					    	<a href="#" class="btn" data-dismiss="modal">Non</a>
					    	<a href="#" class="btn btn-primary">Oui</a>
					    </div>
					</div></td>
				</tr>
				{% endfor %}
				</tbody>
				<tfoot>
					<tr>
						<td>{% trans %}Total{% endtrans %} : {{ users|length }} {% trans %}utilisateur(s){% endtrans %}</td>
						<td colspan="6">
							{% trans %}Afficher{% endtrans %} :
							<select name="filter[display]" onchange="this.form.submit()">
								{% for i in options_pagination %}
									{% if i == nb %}
									<option value="{{ i }}" selected="selected">{{ i }} {% trans %}elements{% endtrans %}</option>
									{% else %}
									<option value="{{ i }}">{{ i }} {% trans %}elements{% endtrans %}</option>
									{% endif %}
								{% endfor %}
							</select>
						</td>
					</tr>
				</tfoot>
			</table>
		</form>
		<div class="navigation">
		    {{ knp_pagination_render(pagination) }}
		</div>
	</div>	
</div>
{% endblock body %}
{% block javascripts %}
<script type="text/javascript">
	$(function() {
		$('select').selectBoxIt();
	});
</script>
{% endblock %}